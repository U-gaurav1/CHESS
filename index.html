<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Chess Game</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #1e3c72, #2a5298);
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      font-family: "Segoe UI", sans-serif;
      color: white;
    }
    #game-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
    }
    #board {
      display: grid;
      grid-template-columns: repeat(8, 60px);
      grid-template-rows: repeat(8, 60px);
      border: 6px solid #222;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.6);
      background: #fff;
    }
    .square {
      width: 60px;
      height: 60px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 36px;
      cursor: pointer;
    }
    .light { background: #f0d9b5; }
    .dark { background: #b58863; }
    .highlight { outline: 3px solid yellow; }
    #status {
      font-size: 18px;
      font-weight: bold;
      margin-top: 8px;
    }
    #footer {
      position: fixed;
      bottom: 10px;
      right: 15px;
      font-size: 14px;
      color: #eee;
      opacity: 0.8;
    }
  </style>
</head>
<body>
  <div id="game-container">
    <div id="board"></div>
    <div id="status">White to move</div>
  </div>
  <div id="footer">Made with ❤ by GauravU</div>

  <script>
    const EMPTY = null;
    let G = {
      board: Array(64).fill(null),
      turn: "w"
    };

    const initial = [
      "r","n","b","q","k","b","n","r",
      "p","p","p","p","p","p","p","p",
      "","","","","","","","",
      "","","","","","","","",
      "","","","","","","","",
      "","","","","","","","",
      "P","P","P","P","P","P","P","P",
      "R","N","B","Q","K","B","N","R"
    ];

    for (let i = 0; i < 64; i++) {
      if (initial[i] === "") continue;
      const piece = initial[i];
      G.board[i] = (piece === piece.toUpperCase() ? "w" : "b") + piece.toUpperCase();
    }

    const boardDiv = document.getElementById("board");
    const statusDiv = document.getElementById("status");

    function inBounds(i){ return i >= 0 && i < 64; }
    function rank(i){ return Math.floor(i / 8); }
    function file(i){ return i % 8; }

    function kingSquare(pos, side){
      return pos.board.findIndex(p => p && p[0] === side && p[1] === "K");
    }

    function isSquareAttacked(pos, sq, by){
      for (let from = 0; from < 64; from++) {
        const piece = pos.board[from];
        if (!piece || piece[0] !== by) continue;
        const pseudo = genPseudoMoves(pos, from);
        if (pseudo.some(m => m.to === sq)) return true;
      }
      return false;
    }

    function clone(pos){
      return { board: pos.board.slice(), turn: pos.turn };
    }

    function genPseudoMoves(pos, from){
      const moves = [];
      const piece = pos.board[from];
      if(!piece) return moves;
      const color = piece[0], type = piece[1];
      const dir = (color === "w") ? -8 : 8;
      const opp = (color === "w") ? "b" : "w";

      function push(target){
        if (inBounds(target)) {
          moves.push({from, to: target});
        }
      }

      if(type === "P"){
        const one = from + dir;
        if(inBounds(one) && !pos.board[one]) push(one);
        for (const d of [-1, 1]) {
          const t = from + dir + d;
          if (inBounds(t) && pos.board[t] && pos.board[t][0] === opp) push(t);
        }
      }

      if(type === "N"){
        const steps = [-17,-15,-10,-6,6,10,15,17];
        for (const s of steps){
          const t = from + s;
          if(!inBounds(t)) continue;
          if(Math.abs(file(from)-file(t))>2) continue;
          if(!pos.board[t] || pos.board[t][0] === opp) push(t);
        }
      }

      if(type === "B" || type === "R" || type === "Q"){
        const dirs = [];
        if(type !== "R"){ dirs.push(-9,-7,7,9); }
        if(type !== "B"){ dirs.push(-8,-1,1,8); }
        for (const d of dirs){
          let t = from + d;
          while(inBounds(t) && Math.abs(file(t)-file(t-d)) <= 1){
            if(!pos.board[t]) { push(t); }
            else {
              if(pos.board[t][0] === opp) push(t);
              break;
            }
            t += d;
          }
        }
      }

      if(type === "K"){
        for (let dr=-1; dr<=1; dr++){
          for (let df=-1; df<=1; df++){
            if(dr===0 && df===0) continue;
            const r = rank(from)+dr, f = file(from)+df;
            if(r<0||r>7||f<0||f>7) continue;
            const t = r*8+f;
            if(!pos.board[t] || pos.board[t][0]===opp) push(t);
          }
        }
      }

      return moves;
    }

    function genLegalMoves(pos, from){
      const pseudo = genPseudoMoves(pos, from);
      const color = pos.board[from][0];
      const legal = [];
      for(const m of pseudo){
        const copy = clone(pos);
        copy.board[m.to] = copy.board[m.from];
        copy.board[m.from] = EMPTY;
        const ksq = kingSquare(copy, color);
        if(!isSquareAttacked(copy, ksq, color === "w" ? "b" : "w")){
          legal.push(m);
        }
      }
      return legal;
    }

    function render(){
      boardDiv.innerHTML = "";
      for (let i = 0; i < 64; i++) {
        const sq = document.createElement("div");
        sq.className = "square " + (((rank(i)+file(i))%2===0)?"light":"dark");
        sq.dataset.index = i;
        const piece = G.board[i];
        if(piece){
          const symbol = {
            "P":"♙","R":"♖","N":"♘","B":"♗","Q":"♕","K":"♔",
            "p":"♟","r":"♜","n":"♞","b":"♝","q":"♛","k":"♚"
          }[piece[1] === piece[1].toUpperCase() ? piece[1] : piece[1].toLowerCase()];
          sq.textContent = (piece[0]==="w") ? symbol : symbol.toLowerCase();
        }
        boardDiv.appendChild(sq);
      }
      statusDiv.textContent = (G.turn==="w" ? "White" : "Black") + " to move";
    }

    let selected = null;
    let legalMoves = [];

    boardDiv.addEventListener("click", e=>{
      const idx = parseInt(e.target.dataset.index);
      if(selected === null){
        const piece = G.board[idx];
        if(piece && piece[0] === G.turn){
          selected = idx;
          legalMoves = genLegalMoves(G, idx);
          highlightMoves();
        }
      } else {
        const move = legalMoves.find(m=>m.to === idx);
        if(move){
          G.board[move.to] = G.board[move.from];
          G.board[move.from] = EMPTY;
          G.turn = (G.turn === "w") ? "b" : "w";
        }
        selected = null;
        legalMoves = [];
        render();
      }
    });

    function highlightMoves(){
      render();
      for(const m of legalMoves){
        const sq = boardDiv.children[m.to];
        sq.classList.add("highlight");
      }
    }

    render();
  </script>
</body>
</html>
